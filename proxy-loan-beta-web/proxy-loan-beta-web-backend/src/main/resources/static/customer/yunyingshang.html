<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>天贝运营商报告</title>
	<link rel="stylesheet" type="text/css" href="/js/jquery-easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="/js/jquery-easyui/themes/icon.css">
	<script type="text/javascript" src="/js/jquery-easyui/jquery.min.js"></script>
	<script type="text/javascript" src="/js/jquery-easyui/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="/js/jquery-easyui/locale/easyui-lang-zh_CN.js"></script>
	<script type="text/javascript" src="/js/loan.js"></script>
	<style type="text/css">
		<!--
		ul{ list-style:none; padding:0px; margin:0px; width:100%;
		height:30px; line-height:30px; border:1px solid #E0ECFF;
		border-top:0px; font-size:12px;}
		ul li{ display:block; width:20%; float:left;text-indent:2em}
		.th{ background:#F1FADE; font-weight:bold; border-top:1px }
		-->
	</style>
</head>
<body>
		<ul class="th">
			<li>运营商数据整理</li>
		</ul>
		<ul style="width: 1200px;height: 300px;">
			<table id="cell_behavior" class="easyui-datagrid" style="width:800px;height: 300px;">
					<thead>
					<tr>
						<th data-options="field:'cell_operator',width:120">运营商</th>
						<th data-options="field:'cell_operator_zh',width:150">运营商（中文）</th>
						<th data-options="field:'cell_phone_num',width:150">号码</th>
						<th data-options="field:'cell_loc',width:150">归属地</th>
						<th data-options="field:'cell_mth',width:150">月份</th>
						<th data-options="field:'call_cnt',width:150">呼叫次数</th>
						<th data-options="field:'call_out_cnt',width:150">主叫次数</th>
						<th data-options="field:'call_out_time',width:150">主叫时间</th>
						<th data-options="field:'call_in_cnt',width:150">被叫次数</th>
						<th data-options="field:'call_in_time',width:150">被叫时间</th>
						<th data-options="field:'net_flow',width:150">流量</th>
						<th data-options="field:'sms_cnt',width:150">短信数目</th>
						<th data-options="field:'total_amount',width:150">话费消费</th>
					</tr>
					</thead>
			</table>
		</ul>
		<ul class="th">
			<li>联系人区域汇总</li>
		</ul>
		<ul style="width: 1200px;height: 300px;">
			<table id="contact_region" class="easyui-datagrid" style="width:1200px;height: 300px;">
					<thead>
					<tr>
						<th data-options="field:'region_loc',width:120">地区名称</th>
						<th data-options="field:'region_uniq_num_cnt',width:150">号码数量</th>
						<th data-options="field:'region_call_in_cnt.interact_mth',width:150">电话呼入次数</th>
						<th data-options="field:'region_call_out_cnt',width:150">电话呼出次数</th>
						<th data-options="field:'region_call_in_time',width:150">电话呼入时间</th>
						<th data-options="field:'region_call_out_time',width:150">电话呼出时间</th>
						<th data-options="field:'region_avg_call_in_time',width:150">平均电话呼入时间</th>
						<th data-options="field:'region_avg_call_out_time',width:150">平均电话呼出时间</th>
						<th data-options="field:'region_call_in_cnt_pct',width:150">电话呼入次数百分比</th>
						<th data-options="field:'region_call_out_cnt_pct',width:150">电话呼出次数百分比</th>
						<th data-options="field:'region_call_in_time_pct',width:150">电话呼入时间百分比</th>
						<th data-options="field:'region_call_out_time_pct',width:150">电话呼出时间百分比</th>
					</tr>
					</thead>
			</table>
		</ul>
		<ul class="th">
			<li>运营商联系人通话详情</li>
		</ul>
		<ul style="width: 1200px;height: 300px;">
			<table id="contact_list" class="easyui-datagrid" style="width:1200px;height: 300px;">
				<thead>
				<tr>
					<th data-options="field:'phone_num',width:120">号码</th>
					<th data-options="field:'phone_num_loc',width:150">号码归属地</th>
					<th data-options="field:'contact_name',width:150">号码标注</th>
					<th data-options="field:'needs_type',width:150">需求类别</th>
					<th data-options="field:'call_cnt',width:150">通话次数</th>
					<th data-options="field:'call_len',width:150">通话时长</th>
					<th data-options="field:'call_out_cnt',width:150">呼出次数</th>
					<th data-options="field:'call_out_len',width:150">呼出时间</th>
					<th data-options="field:'call_in_cnt',width:150">呼入次数</th>
					<th data-options="field:'call_in_len',width:150">呼入时间</th>
					<th data-options="field:'p_relation',width:150">关系推测</th>
					<th data-options="field:'contact_1w',width:150">最近一周联系次数</th>
					<th data-options="field:'contact_1m',width:150">最近一月联系次数</th>
					<th data-options="field:'contact_3m',width:150">最近三月联系次数</th>
					<th data-options="field:'contact_3m_plus',width:150">三个月以上联系次数</th>
					<th data-options="field:'contact_early_morning',width:150">凌晨联系次数</th>
					<th data-options="field:'contact_morning',width:150">上午联系次数</th>
					<th data-options="field:'contact_noon',width:150">中午联系次数</th>
					<th data-options="field:'contact_afternoon',width:150">下午联系次数</th>
					<th data-options="field:'contact_night',width:150">晚上联系次数</th>
					<th data-options="field:'contact_all_day	',width:150">是否全天联系</th>
					<th data-options="field:'contact_weekday',width:150">周中联系次数</th>
					<th data-options="field:'contact_weekend',width:150">周末联系次数</th>
					<th data-options="field:'contact_holiday',width:150">节假日联系次数</th>
				</tr>
				</thead>
			</table>
		</ul>
		<ul class="th">
			<li>常用服务</li>
		</ul>
		<ul style="width:300px;height: 300px;">
			<table id="main_service" class="easyui-datagrid" style="width:800px;height: 300px;">
					<thead>
					<tr>
						<th data-options="field:'company_name',width:120">企业名称</th>
						<th data-options="field:'company_type',width:150">服务企业类型</th>
						<th data-options="field:'XXX',width:150,formatter:showMonth">互动月份</th>
						<th data-options="field:'XXX',width:150,formatter:showTime">月互动次数</th>
					</tr>
					</thead>
			</table>
		</ul>
		<ul class="th">
			<li>电商地址分析</li>
		</ul>
		<ul style="width:300px;height: 300px;">
			<table id="deliver_address" class="easyui-datagrid" style="width:800px;height: 300px;">
				<thead>
				<tr>
					<th data-options="field:'address',width:120">收货地址</th>
					<th data-options="field:'lng',width:150">经度</th>
					<th data-options="field:'lat',width:150">纬度</th>
					<th data-options="field:'predict_addr_type',width:150">地址类型</th>
					<th data-options="field:'begin_date',width:150">开始送货时间</th>
					<th data-options="field:'end_date',width:150">结束送货时间</th>
					<th data-options="field:'total_amount',width:150">总送货金额</th>
					<th data-options="field:'total_count',width:150">总送货次数</th>
					<th data-options="field:'receiver',width:150">收货人列表</th>
					<th data-options="field:'count',width:150">收获次数</th>
					<th data-options="field:'amount',width:150">收获金额</th>
					<th data-options="field:'name',width:150">收货人名称</th>
					<th data-options="field:'phone_num_list',width:150">收货人号码</th>
				</tr>
				</thead>
			</table>

		</ul>
		<ul class="th">
			<li>电商月消费</li>
		</ul>
		<ul style="	width: 300px;height: 300px;">
			<table id="ebusiness_expense" class="easyui-datagrid" style="width:800px;height: 300px;">
				<thead>
				<tr>
					<th data-options="field:'trans_mth',width:120">月份</th>
					<th data-options="field:'all_amount',width:150">全部消费金额</th>
					<th data-options="field:'all_count',width:150">全部消费次数	</th>
					<th data-options="field:'all_category',width:150">本月商品品类</th>
				</tr>
				</thead>
			</table>
		</ul>
		<ul class="th">
			<li>联系人名单</li>
		</ul>
		<ul style="width: 300px;height: 300px;">
			<table id="collection_contact" class="easyui-datagrid" style="width:800px;height: 300px;">
				<thead>
				<tr>
					<th data-options="field:'contact_name',width:120">联系人姓名</th>
					<th data-options="field:'begin_date',width:150">最早出现时间</th>
					<th data-options="field:'end_date',width:150">最晚出现时间	</th>
					<th data-options="field:'total_count',width:150">电商送货总数</th>
					<th data-options="field:'total_amount',width:150">电商送货总金额	</th>
					<th data-options="field:'contact_details',width:150">呼叫信息统计	</th>
				</tr>
				</thead>
			</table>
		</ul>
		<ul class="th">
			<li>出行分析</li>
		</ul>
		<ul style="width: 300px;height: 300px;">
			<table id="trip_info" class="easyui-datagrid" style="width:800px;height: 300px;">
				<thead>
				<tr>
					<th data-options="field:'trip_leave',width:120">出发地</th>
					<th data-options="field:'trip_dest',width:150">目的地</th>
					<th data-options="field:'trip_type',width:150">出行时间类型	</th>
					<th data-options="field:'trip_start_time',width:150">出行开始时间</th>
					<th data-options="field:'trip_end_time',width:150">出行结束时间	</th>
				</tr>
				</thead>
			</table>
		</ul>
	<script type="text/javascript">
		$(function() {
		    Search();
		});
		function Search() {
			var parameter = parent.$("#searchForm").serializeArray();
			var values={};
			for (var item in parameter) {
				if(values[parameter[item].name]!=null||values[parameter[item].name]!=undefined) {
					values[parameter[item].name] = values[parameter[item].name]+","+parameter[item].value.trim();
				}else{
					values[parameter[item].name] = parameter[item].value.trim();
				}
			}

			$.ajax({
				url : queryYysUrl,
				type : "POST",
				contentType:"application/json",
				data :JSON.stringify(values),
				dataType : "json",
				beforeSend: function () {
					$.messager.progress({
					   title: '提示',
					   msg: '数据加载中，请稍候……',
					   text: ''
					});
				},
			   complete: function () {
				 $.messager.progress('close');
				},
				success : function(datas) {
				    if(datas.success){
						console.log(datas.data);
						var dataObj = eval('(' + datas.data + ')');
						if(dataObj.code==0){
							//联系人区域汇总
							$("#cell_behavior").datagrid("loadData",dataObj.data.report.cell_behavior[0].behavior);
							//联系人区域汇总
							$("#contact_region").datagrid("loadData",dataObj.data.report.contact_region);
							//常用服务（main_service）
							$("#main_service").datagrid("loadData",dataObj.data.report.main_service);
							$("#service_details").datagrid("loadData",dataObj.data.report.main_service.service_details);

							$("#interact_cnt").html(dataObj.data.report.main_service.interact_cnt);
							$("#interact_mth").html(dataObj.data.report.main_service.interact_mth);
							//电商地址分析（deliver_address）
							$("#deliver_address").datagrid("loadData",dataObj.data.report.deliver_address);
							//电商月消费
							$("#ebusiness_expense").datagrid("loadData",dataObj.data.report.ebusiness_expense);
							//运营商联系人通话详情（contact_list）
							$("#contact_list").datagrid("loadData",dataObj.data.report.contact_list);
							//联系人名单（collection_contact）
							$("#collection_contact").datagrid("loadData",dataObj.data.report.collection_contact);
							//出行分析
							$("#trip_info").datagrid("loadData",dataObj.data.report.trip_info);
						}else{
							$.messager.alert('温馨提示', dataObj.msg, 'info');
						}
					}else{
				       	$.messager.alert('温馨提示', datas.message, 'info');
					}
				}
			});
		}
		function showMonth(value,row,index) {
			return rows.service_details[index].interact_mth;
        }
		function showTime(value,row,index) {
			return rows.service_details[index].interact_cnt;
		}
	</script>
</body>
</html>